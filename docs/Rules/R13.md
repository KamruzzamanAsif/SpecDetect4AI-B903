# Smell: Empty Column Misinitialization

## Motivation  

Initializing a brand‑new Pandas column with a dummy value such as 0`` or an
empty string `""` is tempting, yet misleading:

it silently forces the column’s dtype `(int64 / object)` and may break
downstream numeric or categorical operations;

it disguises true missingness, making `.isna()` or `dropna()` unable to
spot the yet‑to‑be‑filled rows.

The more explicit sentinel is `np.nan` (or an empty `pd.Serie`s with an
appropriate `dtype`), which keeps the column nullable until real values are
assigned.

---

## Detection strategy (high‑level view)

1. **AST parsing**  
   The source file is transformed into its Abstract Syntax Tree so each
   constructor call can be inspected structurally.

2. **Locate DataFrame column assignments**  
   A node is considered a column write when:
   • it is an `ast.Assign`, and
   • its single target is a subscript (`df["col"]`), and
   • the base object `(df)` is recognised as a Pandas DataFrame in the current scope.


3. **Dummy‑value check**  
   Flag the assignment when the **right‑hand** side is either the literal
   integer `0` or the empty string `""`.
4. **Reporting**  

   When such a node is found the detector emits 
   REPORT: Detected a new column initialized with a filler (0 or ''). Use np.nan or an empty Series instead at line nwhere n is the line number of the offending statement.
---



---

## Practical meaning for the developer 


Prefer an explicit NA marker so downstream code treats the values as missing
until properly set:

```python
# BEFORE – masks missingness
orders["discount"] = 0          # or ""

# AFTER  – preserves nullability
aimport numpy as np
orders["discount"] = np.nan     # or: pd.Series(dtype="float")
```


Using `np.nan` keeps analytical functions `(mean, fillna, …)` reliable and
avoids unexpected `dtype` casts later on.

---

## Limitations  

- The rule only checks for the literals exactly 0 or ""; other fillers
like -1 or custom placeholders are not detected (even if the condition could be easyly added).

- DataFrames created under non‑standard aliases (my_pd.DataFrame) may be
missed.

- Static analysis cannot guarantee that df["col"] = 0 happens on an empty
column; the column could exist already.

